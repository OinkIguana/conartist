version: "3"
services:
  database:
    image: "postgres:10.4"
    environment:
      POSTGRES_USER: default
      POSTGRES_PASSWORD: default
    expose:
      - "5432"
    ports:
      - "5432:5432"
  migrator:
    build: ./database/
    depends_on:
      - database
    environment:
      DATABASE_URL: "postgres://default:default@database:5432/conartist"
    command: ["./wait.sh", "database"]
  # server:
  #   build: .
  #   depends_on:
  #     - database
  #     - migrator
  #   expose:
  #     - "8080"
  #   ports:
  #     - "8080:8080"
  #   environment:
  #     DATABASE_URL: "postgres://conartist_app:temporary-password@database:5432/conartist"
  #     PORT: 8080
